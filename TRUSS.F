c 
90  cls
100 GOSUB 9000
105 PRINT :PRINT "FORCES IN PLANE PIN-JOINTED TRUSSES": PRINT
110 PRINT :PRINT "TYPE IN THE NAME OF YOUR INPUT FILE"
120 INPUT FILENAME$
130 PRINT "IF YOU ARE SATISFIED WITH THIS FILENAME, TYPE Y; ELSE TYPE N"
140 A$ = INKEY$: IF A$ = ""THEN GOTO 140
142 IF A$ = "Y" OR A$ = "y" THEN GOTO 148
144 IF A$ = "N" OR A$ = "n" THEN GOTO 110
146 GOTO 140
148 OPEN FILENAME$ FOR INPUT AS #1
150 PRINT: PRINT "TYPE IN THE NAME OF YOUR OUTPUT FILE"
152 INPUT OUT$
154 PRINT "IF YOU ARE SATISFIED WITH THIS FILENAME, TYPE Y; ELSE TYPE N"
155 B$ = INKEY$: IF B$ = "" THEN GOTO 155
156 IF B$ = "Y" OR B$ = "y" THEN GOTO 159
157 IF B$ = "N" OR B$ = "0" THEN GOTO 150
GOTO 155
159 OPEN OUT$ FOR OUTPUT AS #2
160 NNODE = 2: NDF = 2
170 REM PRINT "TYPE IN NUMBER OF NODES"
180 INPUT #1, NN
182 IF NN < 3 OR NN > 499 THEN GOSUB 9995: PRINT "NO. OF NODES:"; NN: STOP
190 REM PRINT "TYPE IN NUMBER OF MEMBERS"
200 INPUT #1, ES
202 IF ES < 2 OR ES > 499 THEN GOSUB 9995: PRINT "NO. OF ELEMENTS: "; ES: STOP
210 N2 : NN * 2
220 REM PRINT : PRINT "TYPE IN THE NUMBER OF NODES WITH ZERO
DISPLACEMENTS"
230 INPUT #1, NF
232 IF NF < 2 OR NF > NN THEN GOSUB 9995: PRINT "NO. OF NODES WITH ZERO
DISPLACEMENTS:"; NF: STOP
240 DIM SK(4, 4), DC(4, 4)
250 DIM U(N2), SG(4), SL(4), X(NN), Y(NN)
260 DIM XA(ES), XE(ES), XI(ES), XJ(ES)
270 DIM NS(NF * 2), RH(NN), RV(NN), NP(NF), DIAG(N2)
275 REM "TYPE IN THE DETAILS OF THE NODES WITH ZERO 'DISPLACEMENTS'"
280 FOR II : 1 TO NF * 2: NS(lI) : 0: NEXT II
282 FOR II : 1 TO NF: NP(lI) : 0: NEXT II
283 FOR II : 1 TO NF
285 REM PRINT "TYPE IN THE NODE NUMBER OF THE 'SUPPRESSED' NODE "; II
INPUT #1, SU, SUX, SUY
286 IF SU < 1 OR SU > NN THEN GOSUB 9995: PRINT "NO. OF THE NODE WITH ZERO
DISPLACEMENTS:"; NF: STOP
292 REM "IS HORIZONTAL DISPLACEMENT ZERO AT NODE "; SU; " ?
293 IF SUX : 1 THEN Y$ : "Y" ELSE Y$ : "N"
294 IF Y$ : "Y" OR Y$ : "y" OR Y$ : "N" OR Y$ : "0" THEN GOTO 297
296 GOSUB 9995: STOP
297 IF Y$ : "Y" OR Y$ : "y" THEN NS(lI * 2 - 1) : SU * 2 - 1
300 REM "IS VERTICAL DISPLACEMENT ZERO AT NODE "; SU; " ?
302 IF SUY = 1 THEN Y$ = "Y" ELSE Y$ = "N"
304 IF Y$ = "Y" OR Y$ = "N" OR Y$ = "y" OR Y$ = "n" THEN GOTO 310
305 GOSUB 9995: STOP
310 IF Y$ = "Y" OR Y$ = "y" THEN NS(lI * 2) = SU * 2
315 NP(lI) = SU
320 NEXT II
322 REM DETAILS OF NODAL COORDINATES
380 REM "TYPE IN THE NODAL COORDINATES"
390 FOR II = 1 TO NN
400 REM "X & Y COORDS FOR NODE"; II; "=";
410 INPUT #1, X(ll), Y(lI)
440 NEXT II
445 MX = 0
447 REM START OF ELEMENT CYCLE
450 FOR EL = 1 TO ES
460 REM "I,J NODES, ETC. FOR MEMBER "; EL
470 INPUT #1, I, J, AR, E
472 IF I < lOR I > NN THEN GOSUB 9995: PRINT "1="; I; " FOR ELEMENT"; EL: STOP
480 REM PRINT "J NODE FOR MEMBER "; EL; "=";
492 IF J < 1 OR J > NN THEN GOSUB 9995: PRINT "J="; J; " FOR ELEMENT"; E; : STOP
497 IF 1= J THEN GOSUB 9995: PRINT "I = J FOR ELEMENT "; EL: STOP
500 REM "CROSS SECTIONAL AREA FOR MEMBER "; I; "-"; J; "=";AR
515 IF AR < = 0 THEN GOSUB 9995: PRINT "AREA="; AR; "FOR ELEMENT "; EL: STOP
520 REM "ELASTIC MODULUS FOR MEMBER "; I; "-"; J; "=";E
532 IF E < 1 THEN GOSUB 9995: PRINT "YOUNG'S MODULUS="; E; " FOR ELEMENT";
EL:STOP
539 REM END OF INPUT FOR MEMBER EL
540 XI(EL) = I
550 XJ(EL) = J
560 XA(EL) = AR
561 XE(EL) = E
562 FOR II = 1 TO NNODE: IF II = 1 THEN IN = I ELSE IN = J
564 FOR D = 1 TO NDF
565 III = NDF * (IN - 1) + D
566 FOR JJ = 1 TO NNODE: IF JJ = 1 THEN IN = I ELSE IN = J
567 FOR 11 = 1 TO NDF
568 JJ1 = NDF * (IN - 1) + 11
569 IUJ = JJ1 - III + 1: IF IUJ > DIAG(JJ1) THEN DIAG(JJ1) = IUJ
570 NEXT 11, u, D, II, EL
572 DIAG(l) = 1: FOR II = 1 TO N2: DIAG(lI) = DIAG(lI - 1) + DIAG(lI): NEXT II
573 NT = DIAG(N2)
574 DIM A(NT), Q(N2), C(N2)
575 GOSUB 2000
576 GOSUB 2600
577 Z9 = 0: GOSUB ioooo
578 FOR EL = 1 TO ES
579 I = XI(EL): J = XJ(EL)
580 AR = XA(EL)
581 E = XE(EL)
584 PRINT: PRINT "MEMBER NO."; EL; "UNDER COMPUTATION": PRINT
2)
585 L = SQR«X(J) - X(I» ... 2 + (Y(J) - Y(I»
590 KS = (X(J) - XO» I L
600 SN = (Y(J) - Y(I» I L
610 SK(l, 1) = KS 2
620 SK(3, 3) = SK(l, 1)
630 SK(2, 1) = KS * SN
640 SK(l, 2) = SK(2, 1)
650 SK(3, 4) = SK(2, 1)
660 SK(4, 3) = SK(3, 4)
670 SK(3, 1) = -SK(l, 1)
680 SK(l, 3) = SK(3, 1)
690 SK(l, 4) = -SK(2, 1)
700 SK(4, 1) = SK(l, 4)
710 SK(2, 3) = SK(l, 4)
720 SK(3, 2) = SK(2, 3)
730 SK(2, 2) = SN 2
740 SK(4, 4) = SK(2, 2)
750 SK(2, 4) = -SK(2, 2)
760 SK(4, 2) = SK(2, 4)
770 CN = AR * ElL
780 FOR II = 1 TO 4
790 FOR 11 = 1 TO 4
800 SK(lI, JJ) = SK(II, JJ) * CN
810 NEXT 11
820 NEXT II
830 Il = 2 * I - 2
835 J1 = 2 * J - 2
840 FOR II = 1 TO 2
845 FOR 11 = 1 TO 2
850 MM = Il + II
860 MN = n + 11
870 NM = 11 + II
880 N9 = J1 + 11
910 IF 11 > II THEN GOTO 922
915 A(DIAG(MM) + MN - MM) = A(DIAG(MM) + MN - MM) + SK(lI, 11)
920 A(DIAG(NM) + N9 - NM) = A(DIAG(NM) + N9 - NM) + SK(II + 2, 11 + 2)
922 IF n > 11 THEN GOTO 935
925 A(DIAG(NM) + MN - NM) = A(DIAG(NM) + MN - NM) + SK(II + 2, 11)
930 GOTO 940
935 A(DIAG(MM) + N9 - MM) = A(DIAG(MM) + N9 - MM) + SK(lI, 11 + 2)
940 NEXT 11, II
970 NEXTEL
980 FOR II = 1 TO NF * 2
990 N9 = NS(lI)
995 IF N9 = 0 THEN GOTO 1010
997 DI = DIAG(N9)
1000 A(DI) = A(DI) * 1E+ 12 + 1E+ 12
1010 NEXT II
1040 FOR II = 1 TO N2
1065 C(II) = Q(II)
1070 NEXT II
1090 N = N2
1095 PRINT: PRINT "SOLUTION OF THE SIMULTANEOUS EQUATION IS NOW TAKING
PLACE": PRINT
1100 GOSUB 2280
1110 FOR II = 1 TO N2
1120 U(lI) = C(lI)
1160 NEXT II
1180 PRINT #2, : PRINT #2, "THE NODAL DISPLACEMENTS U & V ARE:-": PRINT #2,
1190 FOR II = 1 TO NN
1192 PRINT #2, "NODE="; II;" ";
1195 FOR JJ = 1 TO 2
1200 PRINT #2, U(l1 * 2 - 2 + JJ);" ";
1205 NEXT JJ
1210 PRINT #2, : NEXT II
1220 FOR II = 1 TO 4
1230 FOR JJ = 1 TO 4
1240 DC(lI, JJ) = 0
1250 NEXT JJ
1260 NEXT II
1290 FOR EL = 1 TO ES
1300 AR = XA(EL)
1310 E = XE(EL)
1320 I = XI(EL)
1330 J = XJ(EL)
2 + (Y(J) - Y(I»
2)
1340 L = SQR(X(J) - X(I»
1350 KS = (X(J) - X(l» I L
1360 SN = (Y(J) - Y(I» I L
1370 DC(l, 1) = KS
1380 DC(2, 2) = KS
1390 DC(3, 3) = KS
1400 DC(4, 4) = KS
1410 DC(l, 2) = SN
1420 DC(3, 4) = SN
1430 DC(2, 1) = -SN
1440 DC(4, 3) = -SN
1450 Il = 2 * I - 2
146011 = 2 * J - 2
1470 FOR II = 1 TO 2
1480 MM = Il + II
1490 NM = J 1 + II
1500 SG(lI) = U(MM)
1510 SG(lI + 2) = U(NM)
1520 NEXT II
1530 FOR II = 1 TO 4
1540 SL(II) = 0
1550 FOR JJ = 1 TO 4
1560 SL(lI) = SL(lI) + DC(lI, JJ) * SG(JJ)
1570 NEXT JJ
1580 NEXT II
1590 FC = AR * E * (SL(3) - SL(l» I L
1600 PRINT #2, : PRINT #2, "FORCE IN MEMBER "; I; "-"; J; "="; FC
1610 GOSUB 4000
1620 NEXTEL
1622 GOSUB 4500
1629 GOSUB 11000
1630 STOP
2000 REM ***INPUT OF LOADS***
2010 REM "TYPE IN THE NUMBER OF NODES WITH CONCENTRATED LOADS"
2020 INPUT #1, NC
2030 IF NC < 1 OR NC > NN THEN GOSUB 9995: PRINT "NO. OF NODES WITH
CONCENTRATED LOADS="; NC: STOP
2050 DIM POSW(NC)
2060 FOR II = 1 TO NC
2070 REM "TYPE IN THE NODE NUMBER OF THE NODE, PLUS THE CONCENTRATED
LOADS"
2080 INPUT #1, CN, HW, VW
2090 IF CN < 1 OR CN > NN THEN GOSUB 9995: PRINT "NO. OF NODE WITH THE
CONCENTRATED LOADS="; CN: STOP
2100 POSW(lI) = CN
2120 REM "THE HORIZONTAL COMPONENT OF LOAD (+VE TO RIGHT) "; HW
2130 REM "THE VERTICAL COMPONENT OF LOAD (+VE UPWARDS) "; VW
2140 REM
2160 Q(CN * 2 - 1) = HW: Q(CN * 2) = VW
2180 NEXT II
2190 RETURN
REM SOLUTION OF SIMULTANEOUS EQUATIONS
2280 A(l) = SQR(A(I»
2285 FOR II = 2 TO N
2290 DI = DIAG(lI) - II
2295 LL = DIAG(lI - 1) - DI + 1
2300 FOR JJ = LL TO II
2305 X = A(DI + II)
2310 DJ = DIAG(JJ) - JJ
2315 IF JJ = 1 THEN GOTO 2345
2320 LB = DIAG(JJ - 1) - DJ + 1
2325 IF LL > LB THEN LB = LL
2330 FOR KK = LB TO JJ - 1
2335 X = X - A(DI + KK) * A(DJ + KK)
2340 NEXTKK
2345 A(DI + II) = X I A(DJ + II)
2350 NEXT JJ
2355 A(DI + II) = SQR(X)
2360 NEXT II
2370 C(1) = C(1) I A(I)
2375 FOR II = 2 TO N
2380 DI = DIAG(lI) - II
2385 LL = DIAG(lI - 1) - DI + 1
2390 X = C(lI)
2395 FOR JJ = LL TO II - 1
2400 X = X - A(DI + JJ) * C(JJ)
2405 NEXT JJ
2410 C(lI) = X I A(DI + II)
2415 NEXT II
2420 FOR II = N TO 2 STEP-1
2425 DI = DIAG(lI) - II
2430 X = C(lI) I A(DI + II)
2435 C(lI) = X
2440 LL = DIAG(lI - 1) - DI + 1
2445 FOR KK = LL TO II - 1
2450 C(KK) = C(KK) - X * A(DI + KK)
2455 NEXTKK
2460 NEXT II
2465 C(1) = C(1) / A(I)
2500 RETURN
2600 REM OUTPUT 1
2610 PRINT #2, : PRINT #2, "FORCES IN PIN-JOINTED PLANE TRUSSES"
2620 PRINT #2, : PRINT #2, "PROGRAM BY DR.C.T.F.ROSS"
2630 PRINT #2, : PRINT #2, "NUMBER OF NODES="; NN
2640 PRINT #2, "NUMBER OF MEMBERS="; ES
2650 PRINT #2, "NUMBER OF NODES WITH ZERO DISPLACEMENTS ="; NF
2660 PRINT #2, "DETAILS OF NODES WITH ZERO DISPLACEMENTS"
2670 FOR II = 1 TO NF
2680 SU = INT«NS(lI * 2 - 1) + 1) / 2)
2690 IF SU = 0 THEN SU = INT(NS(lI * 2) / 2)
2700 PRINT #2, "NODE="; SU
2710 N9 = NS(lI * 2 - 1)
2720 IF N9 > 0 THEN PRINT #2, "HORIZONTAL DISPLACEMENT AT NODE "; SU; " IS
ZERO"
2730 N9 = NS(lI * 2)
2740 IF N9 > 0 THEN PRINT #2, "VERTICAL DISPLACEMENT AT NODE "; SU; " IS ZERO"
2750 NEXT II
2760 PRINT #2, : PRINT #2, "NODAL COORDINATES"
2770 FOR II = 1 TO NN
2780 PRINT #2, "X("; II; ")="; X(lI);"
Y("; II; ")="; Y(lI)
2790 NEXT II
2810 PRINT #2, "ELEMENT DETAILS"
2820 FOR EL = 1 TO ES
2830 PRINT #2, "MEMBER "; XI(EL); "-"; XJ(EL)
2840 PRINT #2, "CROSS-SECTIONAL AREA="; XA(EL)
2850 PRINT #2, "YOUNG'S MODULUS="; XE(EL)
2860 NEXTEL
2890 PRINT #2, : PRINT #2, "NUMBER OF NODES WITH CONCENTRATED LOADS="; NC
2900 FOR II = 1 TO NC
2910 PRINT #2, "NODE="; POSW(lI): WPOSN = POSW(lI)
2920 PRINT #2, "HORIZONTAL LOAD="; Q(2 * WPOSN - 1); "
VERTICAL LOAD=";
Q(WPOSN * 2)
2950 NEXT II
2960 RETURN
4000 REM CALCULATION OF REACTIONS
4010RH = 0: RV = 0
4020 FOR II = 1 TO NF
4030 IF XI(EL) = NP(lI) THEN SU = NP(lI): GOTO 4060
4040 NEXT II
4050 GOTO 4100
4060 RH = -FC * KS: RV = -FC * SN
4070 RH(SU) = RH(SU) + RH
4080 RV(SU) = RV(SU) + RV
4100 FOR II = 1 TO NF
4110 IF XJ(EL) = NP(lI) THEN SU = NP(lI): GOTO 4230
4120 NEXT II
4200 GOTO 4320
4230 RH = FC * KS: RV = FC * SN
4300 RH(SU) = RH(SU) + RH
4310 RV(SU) = RV(SU) + RV
4320 RETURN
4500 REM OUTPUT OF REACTIONS
4510 PRINT #2, : PRINT #2, "THE REACTIONS ARE:": PRINT #2,
4520 FOR II = 1 TO NN
4530 IF RH(II) = 0 THEN GOTO 4550
4540 GOTO 4560
4550 IF RV(II) = 0 THEN GOTO 4580
4560 PRINT #2, "NODE="; II;" HORIZONTAL REACTION="; RH(II);" VERTICAL
REACTION="; RV(II)
4580 NEXT II
4600 RETURN
9000 PRINT: PRINT "Copyright of DR.C.T.F.ROSS"
9010 PRINT "NOT TO BE COPIED"
9020 PRINT "Have you read the book:-"
9030 PRINT "FINITE ELEMENT PROGRAMS IN STRUCTURAL ENGINEERING &
CONTINUUM MECHANICS"
9040 PRINT "BY"
9050 PRINT "C.T.F.ROSS."
9060 PRINT "TYPE YIN"
9065 A$ = INKEY$: IF A$ = "" THEN GOTO 9065
9070 IF A$ = "Y" OR A$ = "y" THEN GOTO 9090
9080 PRINT: PRINT "GO BACK & READ IT!": PRINT: STOP
9090 RETURN
9995 REM ***WARNING***
9996 PRINT: PRINT "INCORRECT DATA": PRINT
9997 RETURN
10000 IF Z9 = 0 OR Z9 = 77 THEN SCREEN 9, 0: WIDTH 80: PRINT: PRINT "TO
CONTINUE, TYPE Y"
10004 IF Z9 = 77 OR Z9 = 99 THEN GOTO 10280
10005 XZ = lE+ 12
10010 YZ = lE+ 12
10020 XM = -lE+ 12
10030 YM = -IE+ 12
10040 FOR EL = 1 TO ES
10110 I = XI(EL)
10120 J = XJ(EL)
10130 IF X(I) < XZ THEN XZ = X(I)
10140 IF Y(I) < YZ THEN YZ = Y(I)
10150 IF X(J) < XZ THEN XZ = X(J)
10160 IF Y(J) < YZ THEN YZ = Y(J)
10170 IF X(I) > XM THEN XM = X(I)
10180 IF Y(I) > YM THEN YM = Y(I)
10190 IF X(J) > XM THEN XM = X(J)
10200 IF Y(J) > YM THEN YM = Y(J)
10210 NEXT EL
10250 XS = 450 I (XM - XZ)
10255 IF YM - YZ = 0 THEN GOTO 10280
10260 YS = 225 I (YM - YZ)
10270 IF XS > YS THEN XS = YS
10280 REM THE TRUSS WILL NOW BE DRAWM
10350 FOR EL = 1 TO ES
10360 I = XI(EL)
10370 J = XJ(EL)
10375 IF Z9 = 99 THEN GOTO 10430
10380 XXI = (X(I) - XZ) * XS
10390 YI = (Y(I) - YZ) * XS
10400 XXJ = (X(J) - XZ) * XS
10410 YJ = (Y(J) - YZ) * XS
10420 GOTO 10450
10430 XXI = X(I) - xz * XS: XXJ = X(J) - XZ * XS
10440 YI = Y(I) - YZ * XS: YJ = Y(J) - YZ * XS
10450 REM
10500 LINE (XXI + 20, 300 - YI)-(XXJ + 20, 300 - YJ)
10650 NEXT EL
10670 IF Z9 = 77 THEN GOTO 10800
10680 A$ = INKEY$: IF A$ = "" THEN GOTO 10680
10690 IF A$ = "Y" OR A$ = "y" THEN GOTO 10760
10700 GOTO 10680
10760 SCREEN 0, 0
10800 RETURN
11000 REM PLOT OF DEFLECTED FORM OF FRAME
11010 CLS
11020 PRINT: PRINT "THE DEFLECTED FRAME WILL NOW BE DRAWN"
11030 Z9 = 77
11050 GOSUB 10000
11100 UM = -IE+12
11110 FOR II = 1 TO N2
11160 IF ABS(U(lI)) > UM THEN UM = ABS(U(lI))
11170 NEXT II
11200 SC = 15
11250 FOR II = 1 TO NN
11260 X(lI) = X(lI) * XS + SC * U(2 * II - 1) / UM
11270 Y(lI) = Y(lI) * XS + SC * U(2 * II) / UM
11275 Y(lI) = Y(lI)
11280 NEXT II
11290 Z9 = 99
11300 GOSUB 10000
11400 RETURN
11999 REM END
